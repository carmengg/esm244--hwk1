---
title: "Task 1 - Sierra Amphibians"
author: "Carmen Galaz-Garc√≠a"
date: "1/19/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(here)
library(readxl) # Read in excel files
library(lubridate) 
library(patchwork)
```


```{r}
# ----- DATA READING & SELECTION ----
# raw data
amphibians <- read_excel(here("Task1_sierra_amphibians","sierra_amphibians.xlsx")) 

ranas <- amphibians %>% 
  filter(amphibian_species == "RAMU",              # select mountain yellow-legged frog
         amphibian_life_stage != "EggMass") %>%    # exclude EggMass life stage
  mutate(year = year(ymd(survey_date))) %>%        # extract year into column
  relocate(year) %>%                               # relocate year to 1st column
  drop_na()
```


```{r}
RanasYear <- ranas
RanasYear <- aggregate( RanasYear$amphibian_number, 
               list(year = RanasYear$year, 
                    LifeStage = RanasYear$amphibian_life_stage),
               FUN=sum)

RanasYearGraph <- ggplot(data=RanasYear, aes(x=year, y = x)) +
  geom_line(aes(color=LifeStage))+
  geom_point(aes(colour=LifeStage), alpha =0.5, cex=2)+
  labs( title = "Graph 1. Frogs Observed by Year",
        x= "Year",
        y= "Number of frogs observed (n)",
        color="Life stage")+
  scale_colour_hue(labels = c("Adult", "Subadult", "Tadpole"))+
  theme_light()+
  theme(legend.position = "bottom")    # update legend box position
  
  #theme(legend.key = element_rect(fill = "white", colour = "white"))
RanasYearGraph
```

```{r}
top5lakes <- ranas %>% 
  filter(amphibian_life_stage %in% c("SubAdult", "Adult"))  %>% 
  count(lake_id, wt=amphibian_number) %>% 
  slice_max(n, n=5) 


for(i in 1:5){
  top5lakes$lake_id[i] <- paste("Lake ", top5lakes$lake_id[i])
}

top5graph <- ggplot(data = top5lakes, 
                    aes(x=fct_reorder(lake_id,n), 
                        y =n)) +
  geom_bar(stat = "identity",
           color="gray34", fill="gray57")+
  labs( title = "Graph 2. Top 5 Lakes with Highest Number of Frogs Observed",
        x= "Lake ID",
        y= "Number of frogs observed (n)")+
  theme_light()

top5graph
```


```{r, fig.width = 10}
RanasYearGraph | top5graph
```









